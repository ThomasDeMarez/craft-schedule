{% extends "_layouts/cp" %}

{% do view.registerAssetBundle("panlatent\\schedule\\web\\assets\\logs\\LogsAsset") %}
{% set title = "Logs"|t('schedule') %}
{% set currentSchedule = null %}
{% set selectedSubnavItem = 'logs' %}

{% if scheduleHandle is defined and scheduleHandle is not empty %}
    {% set schedule = craft.schedule.schedules.getScheduleByHandle(scheduleHandle) %}
{% else %}
    {% set schedule = craft.schedule.schedules.getAllSchedules()|first %}
{% endif %}

{% if not schedule %}
    {% exit 404 %}
{% endif %}

{% block content %}
    <div id=app></div>
{% endblock %}

{% css %}
#main-container #main #main-content #content-container #content {
    padding: 0;
}
{% endcss %}

{% block js %}
if (typeof Craft.schedule === 'undefined') {
    Craft.schedule = {
        logs: {}
    }
}
Craft.schedule.logs = {
    api: {
        schedules: {{ actionUrl('schedule/logs/get-schedules')|json_encode|raw }},
        logs: {{ actionUrl('schedule/logs/get-logs')|json_encode|raw }},
    },
    cpTrigger: {{ craft.app.config.general.cpTrigger|json_encode|raw }},
}
{% endblock %}

{% do view.registerJs(block('js'), POS_BEGIN) %}